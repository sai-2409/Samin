<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ - Samin</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/order_tracking.css') }}"
    />
    <!-- Connecting the logo to the browser tab -->
    <link
    rel="shortcut icon"
    href="{{ url_for('static', filename='images/logo__walnuts-print-version.svg') }}"
    type="image/x-icon"
    />
  </head>
  <body>
    <div class="tracking-container">
      <div class="tracking-header">
        <div class="logo">
          <img
            src="{{ url_for('static', filename='images/logoWalnuts-welcome-page.svg') }}"
            alt="Samin Logo"
          />
        </div>
        <h1>–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h1>
        <p class="order-info">
          <span class="order-number"
            >–ó–∞–∫–∞–∑ #<span id="orderId">{{ order_id }}</span></span
          >
          <span class="order-date">{{ order_date }}</span>
        </p>
      </div>

      <div class="tracking-progress">
        <div class="progress-tracker">
          <!-- Progress Percentage -->
          <div class="progress-percentage">
            {% if order_status == '–û—Ñ–æ—Ä–º–ª–µ–Ω' %}50% {% elif order_status ==
            '–°–æ–±—Ä–∞–Ω' %}60% {% elif order_status == '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' %}80% {% elif
            order_status == '–î–æ—Å—Ç–∞–≤–ª–µ–Ω' %}100% {% else %}20%{% endif %}
            –∑–∞–≤–µ—Ä—à–µ–Ω–æ
          </div>

          <!-- Dynamic Progress Bar -->
          <div
            class="progress-fill {% if order_status == '–û—Ñ–æ—Ä–º–ª–µ–Ω' %}progress-20 {% elif order_status == '–°–æ–±—Ä–∞–Ω' %}progress-60 {% elif order_status == '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' %}progress-80 {% elif order_status == '–î–æ—Å—Ç–∞–≤–ª–µ–Ω' %}progress-100 {% else %}progress-20{% endif %}"
          ></div>
          <div class="step completed" data-step="1">
            <div class="step-icon">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M9 12l2 2 4-4" />
              </svg>
            </div>
            <div class="step-label">–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω</div>
            <div class="step-time">{{ order_placed_time }}</div>
          </div>

          <div class="step completed" data-step="2">
            <div class="step-icon">
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M9 12l2 2 4-4" />
              </svg>
            </div>
            <div class="step-label">–û–ø–ª–∞—á–µ–Ω</div>
            <div class="step-time">{{ payment_time }}</div>
          </div>

          <div
            class="step {% if order_status == '–°–æ–±—Ä–∞–Ω' or order_status == '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' or order_status == '–î–æ—Å—Ç–∞–≤–ª–µ–Ω' %}completed {% elif order_status == '–û—Ñ–æ—Ä–º–ª–µ–Ω' %}current {% else %}pending{% endif %}"
            data-step="3"
          >
            <div class="step-icon">
              {% if order_status == '–°–æ–±—Ä–∞–Ω' or order_status == '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' or
              order_status == '–î–æ—Å—Ç–∞–≤–ª–µ–Ω' %}
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M9 12l2 2 4-4" />
              </svg>
              {% elif order_status == '–û—Ñ–æ—Ä–º–ª–µ–Ω' %}
              <div class="loading-spinner"></div>
              {% else %}
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="12" cy="12" r="10" />
              </svg>
              {% endif %}
            </div>
            <div class="step-label">–°–æ–±—Ä–∞–Ω</div>
            <div class="step-time">
              {% if order_status == '–°–æ–±—Ä–∞–Ω' or order_status == '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' or
              order_status == '–î–æ—Å—Ç–∞–≤–ª–µ–Ω' %} {{ status_updated_at if
              status_updated_at else '–ó–∞–≤–µ—Ä—à–µ–Ω–æ' }} {% elif order_status ==
              '–û—Ñ–æ—Ä–º–ª–µ–Ω' %} –í –ø—Ä–æ—Ü–µ—Å—Å–µ {% else %} –û–∂–∏–¥–∞–µ—Ç—Å—è {% endif %}
            </div>
          </div>

          <div
            class="step {% if order_status == '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' or order_status == '–î–æ—Å—Ç–∞–≤–ª–µ–Ω' %}completed {% elif order_status == '–°–æ–±—Ä–∞–Ω' %}current {% else %}pending{% endif %}"
            data-step="4"
          >
            <div class="step-icon">
              {% if order_status == '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' or order_status == '–î–æ—Å—Ç–∞–≤–ª–µ–Ω'
              %}
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M9 12l2 2 4-4" />
              </svg>
              {% elif order_status == '–°–æ–±—Ä–∞–Ω' %}
              <div class="loading-spinner"></div>
              {% else %}
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="12" cy="12" r="10" />
              </svg>
              {% endif %}
            </div>
            <div class="step-label">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω</div>
            <div class="step-time">
              {% if order_status == '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' or order_status == '–î–æ—Å—Ç–∞–≤–ª–µ–Ω'
              %} {{ status_updated_at if status_updated_at else '–ó–∞–≤–µ—Ä—à–µ–Ω–æ' }}
              {% elif order_status == '–°–æ–±—Ä–∞–Ω' %} –í –ø—Ä–æ—Ü–µ—Å—Å–µ {% else %}
              –û–∂–∏–¥–∞–µ—Ç—Å—è {% endif %}
            </div>
          </div>

          <div
            class="step {% if order_status == '–î–æ—Å—Ç–∞–≤–ª–µ–Ω' %}completed {% elif order_status == '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' %}current {% else %}pending{% endif %}"
            data-step="5"
          >
            <div class="step-icon">
              {% if order_status == '–î–æ—Å—Ç–∞–≤–ª–µ–Ω' %}
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M9 12l2 2 4-4" />
              </svg>
              {% elif order_status == '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' %}
              <div class="loading-spinner"></div>
              {% else %}
              <svg
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="12" cy="12" r="10" />
              </svg>
              {% endif %}
            </div>
            <div class="step-label">–î–æ—Å—Ç–∞–≤–ª–µ–Ω</div>
            <div class="step-time">
              {% if order_status == '–î–æ—Å—Ç–∞–≤–ª–µ–Ω' %} {{ status_updated_at if
              status_updated_at else '–ó–∞–≤–µ—Ä—à–µ–Ω–æ' }} {% elif order_status ==
              '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω' %} –í –ø—Ä–æ—Ü–µ—Å—Å–µ {% else %} –û–∂–∏–¥–∞–µ—Ç—Å—è {% endif %}
            </div>
          </div>
        </div>
      </div>

      <div class="order-details">
        <div class="details-card">
          <h3>–î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞</h3>
          <div class="details-grid">
            <div class="detail-item">
              <span class="label">–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞:</span>
              <span class="value">‚ÇΩ{{ order_total }}</span>
            </div>
            <div class="detail-item">
              <span class="label">–°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏:</span>
              <span class="value">{{ delivery_method }}</span>
            </div>
            <div class="detail-item">
              <span class="label">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏:</span>
              <span class="value">{{ delivery_address }}</span>
            </div>
            <div class="detail-item">
              <span class="label">–û–∂–∏–¥–∞–µ–º–∞—è –¥–∞—Ç–∞:</span>
              <span class="value">{{ expected_date }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Products Section -->
      {% if cart_items %}
      <div class="order-products">
        <div class="products-card">
          <h3>–¢–æ–≤–∞—Ä—ã –≤ –∑–∞–∫–∞–∑–µ</h3>
          <div class="products-list">
            {% for item in cart_items %}
            <div class="product-item">
              <div class="product-image">
                <img src="{{ item.image }}" alt="{{ item.productName }}" />
              </div>
              <div class="product-info">
                <h4 class="product-name">{{ item.productName }}</h4>
                <p class="product-size">{{ item.size }}</p>
                <div class="product-details">
                  <span class="product-quantity"
                    >–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: {{ item.quantity }}</span
                  >
                  <span class="product-price">‚ÇΩ{{ item.price }}</span>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
      {% endif %}

      <!-- Delivery Notes Section -->
      {% if delivery_notes %}
      <div class="delivery-notes">
        <div class="notes-card">
          <h3>–ü—Ä–∏–º–µ—á–∞–Ω–∏—è –∫ –¥–æ—Å—Ç–∞–≤–∫–µ</h3>
          <div class="notes-list">
            {% for note in delivery_notes %}
            <div class="note-item">
              <span class="note-icon">üìù</span>
              <span class="note-text">{{ note }}</span>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
      {% endif %}

      <div class="action-buttons">
        <a href="/" class="btn btn-secondary">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–∞–≥–∞–∑–∏–Ω</a>
        <button class="btn btn-primary" onclick="refreshTracking()">
          –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
        </button>
      </div>

      <script>
        // Auto-refresh tracking every 30 seconds
        setInterval(function () {
          refreshTracking();
        }, 30000);

        function refreshTracking() {
          // Reload the page to get updated status
          window.location.reload();
        }
      </script>
    </div>

    <script src="{{ url_for('static', filename='js/order_tracking.js') }}"></script>
  </body>
</html>
